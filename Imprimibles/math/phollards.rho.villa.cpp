ll mulmod(ll a,ll b,ll c){ll x=0,y=a%c;while(b>0){if(b%2==1)x=(x+y)%c;y=(y*2)%c;b/=2;}return x%c;}ll expmod(ll b,ll e,ll m){if(!e)return 1;ll q=expmod(b,e/2,m);q=mulmod(q,q,m);return e%2?mulmod(b,q,m):q;}bool es_primo_prob(ll n,int a){if(n==a)return true;ll s=0,d=n-1;while(d%2==0)s++,d/=2;ll x=expmod(a,d,n);if((x==1)||(x+1==n))return true;forn(i,s-1){x=mulmod(x,x,n);if(x==1)return false;if(x+1==n)return true;}return false;}bool rabin(ll n){if(n==1)return false;const int ar[]={2,3,5,7,11,13,17,19,23};forn(j,9)if(!es_primo_prob(n,ar[j]))return false;return true;}ll rho(ll n){if((n&1)==0)return 2;ll x=2,y=2,d=1;ll c=rand()%n+1;while(d==1){x=(mulmod(x,x,n)+c)%n;y=(mulmod(y,y,n)+c)%n;y=(mulmod(y,y,n)+c)%n;if(x-y>=0)d=gcd(x-y,n);else d=gcd(y-x,n);}return d==n?rho(n):d;}map<ll,ll>prim;void factRho(ll n){if(n==1)return;if(rabin(n)){prim[n]++;return;}ll factor=rho(n);factRho(factor);factRho(n/factor);}
